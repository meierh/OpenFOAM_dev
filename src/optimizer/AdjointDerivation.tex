 % !TEX TS-program = pdflatex
% !TEX encoding = UTF-8 Unicode

\documentclass[10pt]{article} % use larger type; default would be 10pt

\usepackage[utf8]{inputenc} % set input encoding (not needed with XeLaTeX)

%%% PAGE DIMENSIONS
\usepackage{geometry} % to change the page dimensions
\geometry{a4paper} % or letterpaper (US) or a5paper or....
\geometry{margin=1.5cm} % for example, change the margins to 2 inches all round
% \geometry{landscape} % set up the page for landscape
%   read geometry.pdf for detailed page layout information


%%%PACKAGES%%%
\usepackage{subfig} % make it possible to include more than one captioned figure/table in a single float
\usepackage{amsmath} % mathematics

\usepackage{tikz}
\usetikzlibrary{trees}

\usepackage{multirow}
\usepackage{parallel,enumitem}

%%% HEADERS & FOOTERS
\usepackage{fancyhdr} % This should be set AFTER setting up the page geometry
\pagestyle{fancy} % options: empty , plain , fancy
\renewcommand{\headrulewidth}{0pt} % customise the layout...
\lhead{}\chead{}\rhead{}
\lfoot{}\cfoot{\thepage}\rfoot{}

%%% SECTION TITLE APPEARANCE
\usepackage{sectsty}
\allsectionsfont{\sffamily\mdseries\upshape} % (See the fntguide.pdf for font help)
% (This matches ConTeXt defaults)

%%% ToC (table of contents) APPEARANCE
\usepackage[nottoc,notlof,notlot]{tocbibind} % Put the bibliography in the ToC
\usepackage[titles,subfigure]{tocloft} % Alter the style of the Table of Contents
\renewcommand{\cftsecfont}{\rmfamily\mdseries\upshape}
\renewcommand{\cftsecpagefont}{\rmfamily\mdseries\upshape} % No bold!


%%% END Article customizations


\title{Adjoint derivation}
\date{}
%\date{} % Activate to display a given date or no date (if empty),
         % otherwise the current date is printed 

\begin{document}
\maketitle
\begin{center}
	\textbf{Steady adjoint method}\\
	$\text{min}_\Gamma \quad f(\phi,\Gamma)$\\
	$\text{s.t. } g(\phi,\Gamma) = 0$
\end{center}
\begin{Parallel}[v]{0.50\textwidth}{0.5\textwidth}
	\ParallelLText
	{	
		First derivation\\
		\begin{center}
			$\frac{d f}{d \Gamma} = \frac{d f}{d \phi} \frac{d \phi}{d \Gamma} + \frac{df}{d\Gamma}$\\
			$\forall \phi,\Gamma :g(\phi,\Gamma)=0 \rightarrow \frac{d g}{d \Gamma} = 0$\\
			Expand total derivative:\\
			$\frac{d g}{d \Gamma} = \frac{d g}{d \phi}\frac{d \phi}{d \Gamma} + \frac{d g}{d \Gamma} = 0$\\
			$\frac{d\phi}{d\Gamma} = -\left(\frac{dg}{d\phi}\right)^{-1} \frac{dg}{d\Gamma}$\\
			Insert in target function derivative:\\
			$\frac{d f}{d \Gamma} = \frac{d f}{d \phi} \frac{d \phi}{d \Gamma} + \frac{df}{d\Gamma} = - \frac{d f}{d \phi} \left(\frac{dg}{d\phi}\right)^{-1} \frac{dg}{d\Gamma} + \frac{df}{d\Gamma}$\\
			$- \frac{d f}{d \phi} \left(\frac{dg}{d\phi}\right)^{-1} = \lambda$ is the solution to the following equation.\\
			$ \left(\frac{dg}{d\phi}\right)^T \lambda =  -\left(\frac{df}{d\phi}\right)^T $\\
			Leads to the target function derivation\\
			$\frac{d f}{d \Gamma} = \lambda^T \frac{dg}{d\Gamma} + \frac{df}{d\Gamma}$\\
		\end{center}
	}
	\ParallelRText
	{	
		Second derivation\\
		\begin{center}
			$\mathcal{L}(\phi,\Gamma,\lambda) = f(\phi) + \lambda ^ T g(\phi,\Gamma)$\\
			As $g=0$ everywhere:\\
			$\frac{df}{d\Gamma} = \frac{d\mathcal{L}(\phi,\Gamma,\lambda)}{d\Gamma}$\\
			$\frac{df}{d\Gamma} = \frac{df}{d\phi} \frac{d\phi}{d\Gamma} + \frac{df}{d\Gamma} + \frac{d}{d\Gamma} \left(\lambda ^ T g\right) + \lambda ^ T \left(\frac{dg}{d\phi} \frac{d\phi}{d\Gamma} + \frac{dg}{d\Gamma}\right)$\\
			Simplify $g=0$:\\
			$\frac{df}{d\Gamma} = \frac{df}{d\phi} \frac{d\phi}{d\Gamma} + \frac{df}{d\Gamma} + \lambda ^ T \left(\frac{dg}{d\phi} \frac{d\phi}{d\Gamma} + \frac{dg}{d\Gamma}\right)$\\
			Reorder terms:\\
			$\frac{df}{d\Gamma} = \left(\frac{df}{d\phi} + \lambda ^ T \frac{dg}{d\phi}\right) \frac{d\phi}{d\Gamma}  + \lambda ^ T \frac{dg}{d\Gamma} + \frac{df}{d\Gamma}$\\
			Solve $ \left(\frac{dg}{d\phi}\right)^T \lambda =  -\left(\frac{df}{d\phi}\right)^T $ for $\lambda$ to avoid solving $\frac{d\phi}{d\Gamma}$\\
			Leads to:\\
			$\frac{df}{d\Gamma} = \left(0\right) \frac{d\phi}{d\Gamma}  + \lambda ^ T \frac{dg}{d\Gamma} + \frac{df}{d\Gamma}$\\
			Finally:\\
			$\frac{df}{d\Gamma} =  \lambda ^ T \frac{dg}{d\Gamma} + \frac{df}{d\Gamma}$\\
		\end{center}
	}
	\ParallelPar
\end{Parallel}
\newpage
\begin{center}
	\textbf{Unsteady adjoint method}\\
	$\text{min}_\Gamma \quad F(\phi,\Gamma) = \int_{0}^{T} f(\phi,\Gamma,t) dt$\\
	$\text{s.t. } h(\phi,\dot \phi,\Gamma,t) = 0$\\
	$\text{     } g(\phi(t=0),\Gamma) = 0$\\
	$g(\phi(t=0),\Gamma)=0:$ initial condition of unknown parameters\\
	$h(\phi,\dot \phi,\Gamma,t) = 0:$ ODE resulting from semi-discretized PDE: $\dot \phi = \overline{h}(\phi,\Gamma,t)$\\
	Problem:$\frac{\partial F(\phi,\Gamma)}{\partial \Gamma} = \int _0 ^T \left[\frac{\partial f}{\partial \phi} \frac{d \phi}{d \Gamma} + \frac{\partial f}{\partial \Gamma}\right]dt $
\end{center}
\begin{center}
	Introduce Lagrangian $\left[\lambda: \text{Time dependend vector}, \mu: \text{Steady vector}\right]$\\
	$\mathcal{L} = \int_{0}^{T} \left(f(\phi,\Gamma,t) + \lambda(t)^T h(\phi,\dot \phi,\Gamma,t)\right)dt + \mu^T g(\phi(t=0),\Gamma)$\\
	$\frac{d \mathcal{L}}{d\Gamma} = \int_{0}^{T} \left(\frac{df}{d\phi}\frac{d\phi}{d\Gamma} + \frac{df}{d\Gamma} + \lambda(t)^T \left( \frac{dh}{d\phi}\frac{d\phi}{d\Gamma} + \frac{dh}{d\dot \phi}\frac{d\dot \phi}{d\Gamma} + \frac{dh}{d\Gamma}\right) \right)dt + \mu^T \left( \frac{d g}{d\phi(0)} \frac{d \phi(0)}{d\Gamma} + \frac{dg}{d\Gamma} \right)$\\
	Remove $\frac{d\dot \phi}{d\Gamma}$ by using integration by parts:\\
	$\int_{0}^{T} \lambda(t)^T \frac{dh}{d\dot \phi}\frac{d\dot \phi}{d\Gamma} dt = \left[ \lambda^T \frac{dh}{d\dot \phi}\frac{d \phi}{d\Gamma} \right]_0 ^T - \int_{0}^{T} \left[\dot \lambda(t)^T \frac{dh}{d\dot \phi} + \lambda(t)^T \frac{d}{dt}\frac{dh}{d\dot \phi}\right]\frac{d \phi}{d\Gamma} dt$\\
	Restructuring terms to isolate $\frac{d\phi}{d\Gamma}$ and $\frac{d\phi(0)}{d\Gamma}$.\\
	$\frac{d \mathcal{L}}{d\Gamma} = \int_{0}^{T} \left(\frac{df}{d\phi}\frac{d\phi}{d\Gamma} + \lambda^T \frac{dh}{d\phi}\frac{d\phi}{d\Gamma} + \frac{df}{d\Gamma} + \lambda^T \frac{dh}{d\Gamma} +\lambda^T \left( \frac{dh}{d\dot \phi}\frac{d\dot \phi}{d\Gamma}\right) \right)dt + \mu^T \left( \frac{d g}{d\phi(0)} \frac{d \phi(0)}{d\Gamma} + \frac{dg}{d\Gamma} \right)$\\
	Insert the result of partial integration:\\
	$\frac{d \mathcal{L}}{d\Gamma} = \int_{0}^{T} \left(\frac{df}{d\phi}\frac{d\phi}{d\Gamma} + \lambda^T \frac{dh}{d\phi}\frac{d\phi}{d\Gamma} + \frac{df}{d\Gamma} + \lambda^T \frac{dh}{d\Gamma} - \left[\dot \lambda^T \frac{dh}{d\dot \phi} + \lambda^T \frac{d}{dt}\frac{dh}{d\dot \phi}\right]\frac{d \phi}{d\Gamma} \right)dt + \left[ \lambda^T \frac{dh}{d\dot \phi}\frac{d \phi}{d\Gamma} \right]_0 ^T + \mu^T \left( \frac{d g}{d\phi(0)} \frac{d \phi(0)}{d\Gamma} + \frac{dg}{d\Gamma} \right)$\\
	$\frac{d \mathcal{L}}{d\Gamma} = \int_{0}^{T} \left(\left[\frac{df}{d\phi} + \lambda^T \left( \frac{dh}{d\phi} -  \frac{d}{dt}\frac{dh}{d\dot \phi}\right) -\dot \lambda^T \frac{dh}{d\dot \phi}\right]\frac{d \phi}{d\Gamma} + \frac{df}{d\Gamma} + \lambda^T \frac{dh}{d\Gamma}\right)dt + \left[ \lambda^T \frac{dh}{d\dot \phi}\frac{d \phi}{d\Gamma} \right]_0 ^T + \mu^T \left( \frac{d g}{d\phi(0)} \frac{d \phi(0)}{d\Gamma} + \frac{dg}{d\Gamma} \right)$\\
	$\frac{d \mathcal{L}}{d\Gamma} = \int_{0}^{T} \left(\left[\frac{df}{d\phi} + \lambda^T \left( \frac{dh}{d\phi} -  \frac{d}{dt}\frac{dh}{d\dot \phi}\right) -\dot \lambda^T \frac{dh}{d\dot \phi}\right]\frac{d \phi}{d\Gamma} + \frac{df}{d\Gamma} + \lambda^T \frac{dh}{d\Gamma}\right)dt + \left[ \lambda^T \frac{dh}{d\dot \phi}\frac{d \phi}{d\Gamma} \right]_T - \left[ \lambda^T \frac{dh}{d\dot \phi}\frac{d \phi}{d\Gamma} \right]_0 + \mu^T \left( \frac{d g}{d\phi(0)} \frac{d \phi(0)}{d\Gamma} + \frac{dg}{d\Gamma} \right)$\\
	$\frac{d \mathcal{L}}{d\Gamma} = \int_{0}^{T} \left(\left[\frac{df}{d\phi} + \lambda^T \left( \frac{dh}{d\phi} -  \frac{d}{dt}\frac{dh}{d\dot \phi}\right) -\dot \lambda^T \frac{dh}{d\dot \phi}\right]\frac{d \phi}{d\Gamma} + \frac{df}{d\Gamma} + \lambda^T \frac{dh}{d\Gamma}\right)dt + \left[ \lambda^T \frac{dh}{d\dot \phi}\frac{d \phi}{d\Gamma} \right]_T + \left[- \lambda^T \frac{dh}{d\dot \phi} +\mu^T  \frac{d g}{d\phi(0)} \right]_0 \frac{d \phi(0)}{d\Gamma} + \mu^T \frac{dg}{d\Gamma}$\\$ $\\
	Set $\lambda(T) = 0$ \\
	$\frac{d \mathcal{L}}{d\Gamma} = \int_{0}^{T} \left(\left[\frac{df}{d\phi} + \lambda^T \left( \frac{dh}{d\phi} -  \frac{d}{dt}\frac{dh}{d\dot \phi}\right) -\dot \lambda^T \frac{dh}{d\dot \phi}\right]\frac{d \phi}{d\Gamma} + \frac{df}{d\Gamma} + \lambda^T \frac{dh}{d\Gamma}\right)dt + \left[- \lambda^T \frac{dh}{d\dot \phi} +\mu^T  \frac{d g}{d\phi(0)} \right]_0 \frac{d \phi(0)}{d\Gamma} + \mu^T \frac{dg}{d\Gamma}$\\$ $\\
	Set $\mu^T  = \left[ \lambda(t)^T \frac{dh}{d\dot \phi} \left( \frac{d g}{d\phi(0)} \right)^{-1} \right]_0 $ \\
	$\frac{d \mathcal{L}}{d\Gamma} = \int_{0}^{T} \left(\left[\frac{df}{d\phi} + \lambda(t)^T \left( \frac{dh}{d\phi} -  \frac{d}{dt}\frac{dh}{d\dot \phi}\right) -\dot \lambda(t)^T \frac{dh}{d\dot \phi}\right]\frac{d \phi}{d\Gamma} + \frac{df}{d\Gamma} + \lambda(t)^T \frac{dh}{d\Gamma}\right)dt + \mu^T \frac{dg}{d\Gamma}$\\$ $\\$ $\\
	Solution: Set $\left[\frac{df}{d\phi} + \lambda(t)^T \left( \frac{dh}{d\phi} -  \frac{d}{dt}\frac{dh}{d\dot \phi}\right) -\dot \lambda(t)^T \frac{dh}{d\dot \phi}\right]=0$ for $\lambda(t)$ to avoid solving $\frac{d\phi}{d\Gamma}$\\$ $\\
	Leads to :\\
	$\frac{d \mathcal{L}}{d\Gamma} = \int_{0}^{T} \left(\left[0\right]\frac{d \phi}{d\Gamma} + \frac{df}{d\Gamma} + \lambda^T \frac{dh}{d\Gamma}\right)dt + \mu^T \frac{dg}{d\Gamma}$\\
	\underline{Finally}:\\
	$\frac{d \mathcal{L}}{d\Gamma} = \int_{0}^{T} \left(\frac{df}{d\Gamma} + \lambda(t)^T \frac{dh}{d\Gamma}\right)dt + \left[ \lambda(t)^T \frac{dh}{d\dot \phi} \left( \frac{d g}{d\phi(0)} \right)^{-1} \right]_{t=0} \frac{dg}{d\Gamma}$\\$ $\\$ $\\
	Convert to steady: $\dot \lambda = 0$, $\frac{d}{dt} = 0$, $\frac{dh}{d \dot \phi} = 0$\\
	Solve : $\left[\frac{df}{d\phi} + \lambda^T \left( \frac{dh}{d\phi} \right) \right]=0$ for $\lambda$ to avoid solving $\frac{d\phi}{d\Gamma}$\\$ $\\
	$\frac{d \mathcal{L}}{d\Gamma} = \frac{df}{d\Gamma} + \lambda^T \frac{dh}{d\Gamma} $\\
\end{center}
\newpage
\begin{center}
	\textbf{ Immersed Boundary Incompressible Navier Stokes with Nurbs Structure}\\
	Identify $\phi= \left(\vec{u},p,f_u,F_u,U_M,T_{\text{fluid}},f_{T_{\text{fluid}}},F_{T_{\text{fluid}}},T_{\text{fluid}_M},T_{\text{structure}},\vec{U}_\text{structure}\right)^T$\\
	Identify $\Gamma= \left((\vec{P}_{i})_0,...,(\vec{P}_{i})_{\lvert\lvert \text{Struts}\lvert\lvert-1},r_0,...,r_{\lvert\lvert \text{Struts}\lvert\lvert-1} \right)^T$\\
\begin{flushleft}
	Navier Stokes Equations:
\end{flushleft}
	$ \text{NS}_{\text{conti}} =- \nabla \cdot \vec{u} = 0$\\
	$ \text{NS}_{\text{mom}} = \frac{\partial \vec{u}}{\partial t} + (\vec{u} \cdot \nabla) \vec{u} - \frac{\mu}{\rho} \nabla \cdot \nabla \vec{u} + \frac{1}{\rho} \nabla p - f_u = 0$\\
	$\text{NS}_{\text{f}_u} = f_u (\vec{x}) - \sum_{X} F_u (X) \delta (\vec{x}-\vec{X}) = 0$\\
	$\text{NS}_{\text{F}_u} = F_u (\vec{X}) - \frac{U_G (\vec{X}) - U_M(\vec{X})}{\Delta t} = 0$\\
	$\text{NS}_{\text{U}_M} = U_M (\vec{X}) - \int u(\vec{x}) \delta(\vec{x}-\vec{X}) d \Omega= 0$\\
	$\text{NS}_{\text{T}_{\text{fluid}}} = \frac{\partial T_{\text{fluid}}}{\partial t} + \vec{u} \cdot \nabla T_{\text{fluid}} - \frac{\kappa}{\rho c_p} \nabla \cdot \nabla T_{\text{fluid}} - \int_{\Omega} \frac{T_{\text{M,fluid}} - \int_{\Omega} T_{\text{fluid}} \delta(\vec{x}-\vec{X}) d\Omega}{\Delta T} d\Omega = 0$\\
	$\text{NS}_{\text{f}_{\text{T}_{\text{fluid}}}} = f_{\text{T}_{\text{fluid}}} (\vec{x}) - \sum_{X} F_{\text{T}_{\text{fluid}}} (X) \delta (\vec{x}-\vec{X}) = 0$\\
	$\text{NS}_{\text{F}_{\text{T}_{\text{fluid}}}} = F_{\text{T}_{\text{fluid}}} (\vec{X}) - \frac{{\text{T}_{\text{fluid}}}_G (\vec{X}) - {\text{T}_{\text{fluid}}}_M(\vec{X})}{\Delta t} = 0$\\
	$\text{NS}_{\text{T}_{\text{fluid}_M}} = \text{T}_{\text{fluid}_M} (\vec{X}) - \int {\text{T}_{\text{fluid}}}(\vec{x}) \delta(\vec{x}-\vec{X}) d \Omega= 0$\\
\begin{flushleft}
	Navier Stokes Boundary Conditions:
\end{flushleft}
	$\vec{u}(x)=\vec{U}_{\text{Wall}} \quad \frac{\partial p}{\partial \vec{n}}(x)=0 \quad  T(x) = T_{\text{Wall}} \quad  \text{at } x \in X_{\text{Wall}}$\\
	$\vec{u}(x)=\vec{U}_{\text{inlet}} \quad \frac{\partial p}{\partial \vec{n}}(x)=0 \quad  T(x) = T_{\text{inlet}} \quad \text{at } x \in X_{\text{inlet}}$\\
	$\frac{\partial \vec{U}}{\partial \vec{n}}(x) = 0\quad p(x)=p_{\text{outlet}} \quad  \frac{\partial T}{\partial \vec{n}_{\text{outlet}}}(x) = 0 \quad \text{at } x \in X_{\text{outlet}}$\\
\begin{flushleft}
	Navier Stokes \& Structure Coupling Conditions:
\end{flushleft}
	$\vec{u}(x_{\text{solid}}\left(s,\theta\right))= \frac{\partial \vec{C}(s,t)}{\partial t} \quad \quad \text{at } s \in S_{\text{Strut}}$\\
	$ \vec{F}_{\text{solid}}(s) = \int_0^{2\pi} \tau_{\text{fluid}}(x_{\text{solid}}(s,\theta)) \cdot \vec{n} r d\theta \quad  \quad \text{at } s \in S_{\text{Strut}}$\\
	$ \pi r^2 \lambda_{\text{solid}} \frac{\partial T_{\text{solid}}(s)}{\partial s} = \int_0^{2\pi} \dot q_{\text{fluid}}(x_{\text{solid}}(s,\theta)) \cdot \vec{n} r d\theta \quad  \quad \text{at } s \in S_{\text{Strut}}$\\
	using\\
	$\tau_{\text{fluid}} = - p I + \mu \left(\nabla u + \nabla u ^T\right)$\\
	$\dot q_{\text{fluid}} = - \lambda_{\text{fluid}} \nabla T_{\text{fluid}}$\\
	$x_{\text{solid}}\left(s,\theta\right) = \vec{C}(s,t) + r\frac{\vec{C}(s,t)_{ss}}{\lvert \lvert \vec{C}(s,t)_{ss} \lvert \lvert_2}\sin(\theta) + r\frac{\vec{C}(s,t)_{ss} \times \vec{C}(s,t)_{s}}{\lvert \lvert \vec{C}(s,t)_{ss} \times \vec{C}(s,t)_{s} \lvert \lvert_2}\cos(\theta) $\\
\begin{flushleft}
	Structure Equations:
\end{flushleft}
	$X(s,...) = 0$\\
	$T_{\text{solid}}(s,...) =0$\\
\begin{flushleft}
	Structure Boundary Equation:
\end{flushleft}
	$\text{RB}_X(s,...) = 0$\\
	$\text{RB}_T(s,...) =0$\\
\end{center}
\newpage
\begin{center}
	\textbf{Optimization Immersed Boundary Incompressible Navier Stokes with Nurbs Structure}
\begin{flushleft}
	Optimization problem
\end{flushleft}	
	minimize $J(\Gamma,\phi)$\\
	subject to $\text{NS}(\phi) = 0$
\begin{flushleft}
	Lagrangian formulation
\end{flushleft}	
	$L = J + \int_{\Omega} \vec{\lambda} \cdot \text{NS}(\phi)  d\Omega$\\
	$\delta L = \delta_\Gamma L + \delta_\phi L$\\
\begin{flushleft}
	Variational Immersed Boundary Navier Stokes
\end{flushleft}
\begin{flushleft}
	$\delta \vec{u} \text{NS}:$
\end{flushleft}
	$\delta \vec{u} \text{NS}_{\text{mom}} = (\vec{u}\cdot\nabla) \delta{\vec{u}} + (\delta{\vec{u}}\cdot\nabla)\vec{u}-\frac{\mu}{\rho} \Delta \delta{\vec{u}}$\\
	$\delta \vec{u} \text{NS}_{\text{conti}} = - \nabla \cdot \delta\vec{u}$\\
	$\delta \vec{u} \text{NS}_{\text{f}_u} = 0$\\
	$\delta \vec{u} \text{NS}_{\text{F}_u} = 0$\\
	$\delta \vec{u} \text{NS}_{\text{U}_M} =  - \int \delta u(\vec{x}) \delta(\vec{x}-\vec{X}) d \Omega$\\
	$\delta \vec{u} \text{NS}_{\text{T}_{\text{fluid}}} = \delta\vec{u} \cdot \nabla T_{\text{fluid}}$\\
	$\delta \vec{u} \text{NS}_{\text{f}_{\text{T}_{\text{fluid}}}} = 0$\\
	$\delta \vec{u} \text{NS}_{\text{F}_{\text{T}_{\text{fluid}}}} = 0$\\
	$\delta \vec{u} \text{NS}_{\text{T}_{\text{fluid}_M}} = 0$\\
\begin{flushleft}
	$\delta p \text{NS}:$
\end{flushleft}
	$\delta p \text{NS}_{\text{mom}} =  \frac{1}{\rho} \nabla \delta p$\\
	$\delta p \text{NS}_{\text{conti}} = 0$\\
	$\delta p \text{NS}_{\text{f}_u} = 0$\\
	$\delta p \text{NS}_{\text{F}_u} = 0$\\
	$\delta p \text{NS}_{\text{U}_M} = 0$\\
	$\delta p \text{NS}_{\text{T}_{\text{fluid}}} = 0$\\
	$\delta p \text{NS}_{\text{f}_{\text{T}_{\text{fluid}}}} = 0$\\
	$\delta p \text{NS}_{\text{F}_{\text{T}_{\text{fluid}}}} = 0$\\
	$\delta p \text{NS}_{\text{T}_{\text{fluid}_M}} = 0$\\
\begin{flushleft}
	$\delta f_u \text{NS}:$
\end{flushleft}
	$\delta f_u \text{NS}_{\text{mom}} =  -\delta f_u$\\
	$\delta f_u \text{NS}_{\text{conti}} = 0$\\
	$\delta f_u \text{NS}_{\text{f}_u} = \delta f_u$\\
	$\delta f_u \text{NS}_{\text{F}_u} = 0$\\
	$\delta f_u \text{NS}_{\text{U}_M} = 0$\\
	$\delta f_u \text{NS}_{\text{T}_{\text{fluid}}} = 0$\\
	$\delta f_u \text{NS}_{\text{f}_{\text{T}_{\text{fluid}}}} = 0$\\
	$\delta f_u \text{NS}_{\text{F}_{\text{T}_{\text{fluid}}}} = 0$\\
	$\delta f_u \text{NS}_{\text{T}_{\text{fluid}_M}} = 0$\\
\begin{flushleft}
	$\delta F_u \text{NS}:$
\end{flushleft}
	$\delta F_u \text{NS}_{\text{mom}} =  0$\\
	$\delta F_u \text{NS}_{\text{conti}} = 0$\\
	$\delta F_u \text{NS}_{\text{f}_u} = -\sum_X \delta F_u \delta (\vec{x}-\vec{X})$\\
	$\delta F_u \text{NS}_{\text{F}_u} = \delta F_u$\\
	$\delta F_u \text{NS}_{\text{U}_M} = 0$\\
	$\delta F_u \text{NS}_{\text{T}_{\text{fluid}}} = 0$\\
	$\delta F_u \text{NS}_{\text{f}_{\text{T}_{\text{fluid}}}} = 0$\\
	$\delta F_u \text{NS}_{\text{F}_{\text{T}_{\text{fluid}}}} = 0$\\
	$\delta F_u \text{NS}_{\text{T}_{\text{fluid}_M}} = 0$\\
\begin{flushleft}
	$\delta U_M \text{NS}:$
\end{flushleft}
	$\delta U_M \text{NS}_{\text{mom}} =  0$\\
	$\delta U_M \text{NS}_{\text{conti}} = 0$\\
	$\delta U_M \text{NS}_{\text{f}_u} = 0$\\
	$\delta U_M \text{NS}_{\text{F}_u} = \frac{\delta U_M}{\Delta t}$\\
	$\delta U_M \text{NS}_{\text{U}_M} = \delta U_M$\\
	$\delta U_M \text{NS}_{\text{T}_{\text{fluid}}} = 0$\\
	$\delta U_M \text{NS}_{\text{f}_{\text{T}_{\text{fluid}}}} = 0$\\
	$\delta U_M \text{NS}_{\text{F}_{\text{T}_{\text{fluid}}}} = 0$\\
	$\delta U_M \text{NS}_{\text{T}_{\text{fluid}_M}} = 0$\\
\begin{flushleft}
	$\delta T_{\text{fluid}} \text{NS}:$
\end{flushleft}
	$\delta T_{\text{fluid}} \text{NS}_{\text{mom}} =  0$\\
	$\delta T_{\text{fluid}} \text{NS}_{\text{conti}} = 0$\\
	$\delta T_{\text{fluid}} \text{NS}_{\text{f}_u} = 0$\\
	$\delta T_{\text{fluid}} \text{NS}_{\text{F}_u} = 0$\\
	$\delta T_{\text{fluid}} \text{NS}_{\text{U}_M} = 0$\\
	$\delta T_{\text{fluid}} \text{NS}_{\text{T}_{\text{fluid}}} =  \vec{u} \cdot \nabla \delta T_{\text{fluid}} - \frac{\kappa}{\rho c_p} \nabla \cdot \nabla \delta T_{\text{fluid}}$\\
	$\delta T_{\text{fluid}} \text{NS}_{\text{f}_{\text{T}_{\text{fluid}}}} = 0$\\
	$\delta T_{\text{fluid}} \text{NS}_{\text{F}_{\text{T}_{\text{fluid}}}} = 0$\\
	$\delta T_{\text{fluid}} \text{NS}_{\text{T}_{\text{fluid}_M}} = -\int \delta T_{\text{fluid}} \delta (\vec{x}-\vec{X}) d\Omega$\\
\begin{flushleft}
	$\delta f_{\text{T}_{\text{fluid}}} \text{NS}:$
\end{flushleft}
	$\delta f_{\text{T}_{\text{fluid}}} \text{NS}_{\text{mom}} =  0$\\
	$\delta f_{\text{T}_{\text{fluid}}} \text{NS}_{\text{conti}} = 0$\\
	$\delta f_{\text{T}_{\text{fluid}}} \text{NS}_{\text{f}_u} = 0$\\
	$\delta f_{\text{T}_{\text{fluid}}} \text{NS}_{\text{F}_u} = 0$\\
	$\delta f_{\text{T}_{\text{fluid}}} \text{NS}_{\text{U}_M} = 0$\\
	$\delta f_{\text{T}_{\text{fluid}}} \text{NS}_{\text{T}_{\text{fluid}}} = -\delta f_{\text{T}_{\text{fluid}}}$\\
	$\delta f_{\text{T}_{\text{fluid}}} \text{NS}_{\text{f}_{\text{T}_{\text{fluid}}}} = \delta f_{\text{T}_{\text{fluid}}}$\\
	$\delta f_{\text{T}_{\text{fluid}}} \text{NS}_{\text{F}_{\text{T}_{\text{fluid}}}} = 0$\\
	$\delta f_{\text{T}_{\text{fluid}}} \text{NS}_{\text{T}_{\text{fluid}_M}} = 0$\\
\begin{flushleft}
	$\delta F_{\text{T}_{\text{fluid}}} \text{NS}:$
\end{flushleft}
	$\delta F_{\text{T}_{\text{fluid}}} \text{NS}_{\text{mom}} = 0$\\
	$\delta F_{\text{T}_{\text{fluid}}} \text{NS}_{\text{conti}} = 0$\\
	$\delta F_{\text{T}_{\text{fluid}}} \text{NS}_{\text{f}_u} = 0$\\
	$\delta F_{\text{T}_{\text{fluid}}} \text{NS}_{\text{F}_u} = 0$\\
	$\delta F_{\text{T}_{\text{fluid}}} \text{NS}_{\text{U}_M} = 0$\\
	$\delta F_{\text{T}_{\text{fluid}}} \text{NS}_{\text{T}_{\text{fluid}}} = 0 $\\
	$\delta F_{\text{T}_{\text{fluid}}} \text{NS}_{\text{f}_{\text{T}_{\text{fluid}}}} = -\sum_X \delta F_{\text{T}_{\text{fluid}}} \delta (\vec{x}-\vec{X})$\\
	$\delta F_{\text{T}_{\text{fluid}}} \text{NS}_{\text{F}_{\text{T}_{\text{fluid}}}} = \delta F_{\text{T}_{\text{fluid}}}$\\
	$\delta F_{\text{T}_{\text{fluid}}} \text{NS}_{\text{T}_{\text{fluid}_M}} = 0$\\
\begin{flushleft}
	$\delta T_M \text{NS}:$
\end{flushleft}
	$\delta T_M \text{NS}_{\text{mom}} =  0$\\
	$\delta T_M \text{NS}_{\text{conti}} = 0$\\
	$\delta T_M \text{NS}_{\text{f}_u} = 0$\\
	$\delta T_M \text{NS}_{\text{F}_u} = 0$\\
	$\delta T_M \text{NS}_{\text{U}_M} = 0$\\
	$\delta T_M \text{NS}_{\text{T}_{\text{fluid}}} = 0$\\
	$\delta T_M \text{NS}_{\text{f}_{\text{T}_{\text{fluid}}}} = 0$\\
	$\delta T_M \text{NS}_{\text{F}_{\text{T}_{\text{fluid}}}} = \frac{\delta T_M}{\Delta t}$\\
	$\delta T_M \text{NS}_{\text{T}_{\text{fluid}_M}} = \delta T_M$\\
\newpage
\begin{flushleft}
	Variational Immersed Boundary Navier Stokes
\end{flushleft}
$\delta_\phi L = \delta_\phi J + \delta_\phi \int_{\Omega \cup X} \vec{\lambda} \cdot \text{NS}(\phi)
	d\Omega\cup X $\\
$\delta_\phi L = \delta \vec{u} J + \delta p J + \delta f_u J + \delta F_u J + \delta U_M J +
	\delta T_{\text{fluid}} J + \delta f_{T_{\text{fluid}}} J + \delta F_{T_{\text{fluid}}} J + \delta T_M J +$\\
    $\int_{\Omega \cup X}
	\begin{pmatrix}
		\lambda_{\vec{u}} \\ \lambda_p \\ \lambda_{f_u} \\ \lambda_{F_u} \\ \lambda_{U_M}\\ \lambda_{T_{\text{fluid}}} \\ \lambda_{f_{T_{\text{fluid}}}} \\ \lambda_{F_{T_{\text{fluid}}}} \\ \lambda_{T_{\text{fluid}_M}}
	\end{pmatrix}
	\cdot
	\begin{pmatrix}
		\delta \vec{u} \text{NS}_{\text{mom}} \\
		\delta \vec{u} \text{NS}_{\text{conti}}\\
		\delta \vec{u} \text{NS}_{\text{f}_u} \\
		\delta \vec{u} \text{NS}_{\text{F}_u} \\
		\delta \vec{u} \text{NS}_{\text{U}_M} \\
		\delta \vec{u} \text{NS}_{\text{T}_{\text{fluid}}} \\
		\delta \vec{u} \text{NS}_{\text{f}_{\text{T}_{\text{fluid}}}}\\
		\delta \vec{u} \text{NS}_{\text{F}_{\text{T}_{\text{fluid}}}}\\
		\delta \vec{u} \text{NS}_{\text{T}_{\text{fluid}_M}}\\
	\end{pmatrix}
	d\Omega \cup X + $\\

	$\int_{\Omega \cup X}
	\begin{pmatrix}
		\lambda_{\vec{u}} \\ \lambda_p \\ \lambda_{f_u} \\ \lambda_{F_u} \\ \lambda_{U_M}\\ \lambda_{T_{\text{fluid}}} \\ \lambda_{f_{T_{\text{fluid}}}} \\ \lambda_{F_{T_{\text{fluid}}}} \\ \lambda_{T_{\text{fluid}_M}}
	\end{pmatrix}
	\cdot
	\begin{pmatrix}
		\delta p \text{NS}_{\text{mom}} \\
		\delta p \text{NS}_{\text{conti}}\\
		\delta p \text{NS}_{\text{f}_u} \\
		\delta p \text{NS}_{\text{F}_u} \\
		\delta p \text{NS}_{\text{U}_M} \\
		\delta p \text{NS}_{\text{T}_{\text{fluid}}} \\
		\delta p \text{NS}_{\text{f}_{\text{T}_{\text{fluid}}}}\\
		\delta p \text{NS}_{\text{F}_{\text{T}_{\text{fluid}}}}\\
		\delta p \text{NS}_{\text{T}_{\text{fluid}_M}}\\
	\end{pmatrix}
	d\Omega \cup X + $\\

	$\int_{\Omega \cup X}
	\begin{pmatrix}
		\lambda_{\vec{u}} \\ \lambda_p \\ \lambda_{f_u} \\ \lambda_{F_u} \\ \lambda_{U_M}\\ \lambda_{T_{\text{fluid}}} \\ \lambda_{f_{T_{\text{fluid}}}} \\ \lambda_{F_{T_{\text{fluid}}}} \\ \lambda_{T_{\text{fluid}_M}}
	\end{pmatrix}
	\cdot
	\begin{pmatrix}
		\delta f_u \text{NS}_{\text{mom}} \\
		\delta f_u \text{NS}_{\text{conti}}\\
		\delta f_u \text{NS}_{\text{f}_u} \\
		\delta f_u \text{NS}_{\text{F}_u} \\
		\delta f_u \text{NS}_{\text{U}_M} \\
		\delta f_u \text{NS}_{\text{T}_{\text{fluid}}} \\
		\delta f_u \text{NS}_{\text{f}_{\text{T}_{\text{fluid}}}}\\
		\delta f_u \text{NS}_{\text{F}_{\text{T}_{\text{fluid}}}}\\
		\delta f_u \text{NS}_{\text{T}_{\text{fluid}_M}}\\
	\end{pmatrix}
	d\Omega \cup X + $\\

	$\int_{\Omega \cup X}
	\begin{pmatrix}
		\lambda_{\vec{u}} \\ \lambda_p \\ \lambda_{f_u} \\ \lambda_{F_u} \\ \lambda_{U_M}\\ \lambda_{T_{\text{fluid}}} \\ \lambda_{f_{T_{\text{fluid}}}} \\ \lambda_{F_{T_{\text{fluid}}}} \\ \lambda_{T_{\text{fluid}_M}}
	\end{pmatrix}
	\cdot
	\begin{pmatrix}
		\delta F_u \text{NS}_{\text{mom}} \\
		\delta F_u \text{NS}_{\text{conti}}\\
		\delta F_u \text{NS}_{\text{f}_u} \\
		\delta F_u \text{NS}_{\text{F}_u} \\
		\delta F_u \text{NS}_{\text{U}_M} \\
		\delta F_u \text{NS}_{\text{T}_{\text{fluid}}} \\
		\delta F_u \text{NS}_{\text{f}_{\text{T}_{\text{fluid}}}}\\
		\delta F_u \text{NS}_{\text{F}_{\text{T}_{\text{fluid}}}}\\
		\delta F_u \text{NS}_{\text{T}_{\text{fluid}_M}}\\
	\end{pmatrix}
	d\Omega \cup X + $\\

	$\int_{\Omega \cup X}
	\begin{pmatrix}
		\lambda_{\vec{u}} \\ \lambda_p \\ \lambda_{f_u} \\ \lambda_{F_u} \\ \lambda_{U_M}\\ \lambda_{T_{\text{fluid}}} \\ \lambda_{f_{T_{\text{fluid}}}} \\ \lambda_{F_{T_{\text{fluid}}}} \\ \lambda_{T_{\text{fluid}_M}}
	\end{pmatrix}
	\cdot
	\begin{pmatrix}
		\delta U_M \text{NS}_{\text{mom}} \\
		\delta U_M \text{NS}_{\text{conti}}\\
		\delta U_M \text{NS}_{\text{f}_u} \\
		\delta U_M \text{NS}_{\text{F}_u} \\
		\delta U_M \text{NS}_{\text{U}_M} \\
		\delta U_M \text{NS}_{\text{T}_{\text{fluid}}} \\
		\delta U_M \text{NS}_{\text{f}_{\text{T}_{\text{fluid}}}}\\
		\delta U_M \text{NS}_{\text{F}_{\text{T}_{\text{fluid}}}}\\
		\delta U_M \text{NS}_{\text{T}_{\text{fluid}_M}}\\
	\end{pmatrix}
	d\Omega \cup X + $\\

	$\int_{\Omega \cup X}
	\begin{pmatrix}
		\lambda_{\vec{u}} \\ \lambda_p \\ \lambda_{f_u} \\ \lambda_{F_u} \\ \lambda_{U_M}\\ \lambda_{T_{\text{fluid}}} \\ \lambda_{f_{T_{\text{fluid}}}} \\ \lambda_{F_{T_{\text{fluid}}}} \\ \lambda_{T_{\text{fluid}_M}}
	\end{pmatrix}
	\cdot
	\begin{pmatrix}
		\delta T_{\text{fluid}} \text{NS}_{\text{mom}} \\
		\delta T_{\text{fluid}} \text{NS}_{\text{conti}}\\
		\delta T_{\text{fluid}} \text{NS}_{\text{f}_u} \\
		\delta T_{\text{fluid}} \text{NS}_{\text{F}_u} \\
		\delta T_{\text{fluid}} \text{NS}_{\text{U}_M} \\
		\delta T_{\text{fluid}} \text{NS}_{\text{T}_{\text{fluid}}} \\
		\delta T_{\text{fluid}} \text{NS}_{\text{f}_{\text{T}_{\text{fluid}}}}\\
		\delta T_{\text{fluid}} \text{NS}_{\text{F}_{\text{T}_{\text{fluid}}}}\\
		\delta T_{\text{fluid}} \text{NS}_{\text{T}_{\text{fluid}_M}}\\
	\end{pmatrix}
	d\Omega \cup X + $\\

		$\int_{\Omega \cup X}
	\begin{pmatrix}
		\lambda_{\vec{u}} \\ \lambda_p \\ \lambda_{f_u} \\ \lambda_{F_u} \\ \lambda_{U_M}\\ \lambda_{T_{\text{fluid}}} \\ \lambda_{f_{T_{\text{fluid}}}} \\ \lambda_{F_{T_{\text{fluid}}}} \\ \lambda_{T_{\text{fluid}_M}}
	\end{pmatrix}
	\cdot
	\begin{pmatrix}
		\delta f_{\text{T}_{\text{fluid}}} \text{NS}_{\text{mom}} \\
		\delta f_{\text{T}_{\text{fluid}}} \text{NS}_{\text{conti}}\\
		\delta f_{\text{T}_{\text{fluid}}} \text{NS}_{\text{f}_u} \\
		\delta f_{\text{T}_{\text{fluid}}} \text{NS}_{\text{F}_u} \\
		\delta f_{\text{T}_{\text{fluid}}} \text{NS}_{\text{U}_M} \\
		\delta f_{\text{T}_{\text{fluid}}} \text{NS}_{\text{T}_{\text{fluid}}} \\
		\delta f_{\text{T}_{\text{fluid}}} \text{NS}_{\text{f}_{\text{T}_{\text{fluid}}}}\\
		\delta f_{\text{T}_{\text{fluid}}} \text{NS}_{\text{F}_{\text{T}_{\text{fluid}}}}\\
		\delta f_{\text{T}_{\text{fluid}}} \text{NS}_{\text{T}_{\text{fluid}_M}}\\
	\end{pmatrix}
	d\Omega \cup X + $\\

		$\int_{\Omega \cup X}
	\begin{pmatrix}
		\lambda_{\vec{u}} \\ \lambda_p \\ \lambda_{f_u} \\ \lambda_{F_u} \\ \lambda_{U_M}\\ \lambda_{T_{\text{fluid}}} \\ \lambda_{f_{T_{\text{fluid}}}} \\ \lambda_{F_{T_{\text{fluid}}}} \\ \lambda_{T_{\text{fluid}_M}}
	\end{pmatrix}
	\cdot
	\begin{pmatrix}
		\delta F_{\text{T}_{\text{fluid}}} \text{NS}_{\text{mom}} \\
		\delta F_{\text{T}_{\text{fluid}}} \text{NS}_{\text{conti}}\\
		\delta F_{\text{T}_{\text{fluid}}} \text{NS}_{\text{f}_u} \\
		\delta F_{\text{T}_{\text{fluid}}} \text{NS}_{\text{F}_u} \\
		\delta F_{\text{T}_{\text{fluid}}} \text{NS}_{\text{U}_M} \\
		\delta F_{\text{T}_{\text{fluid}}} \text{NS}_{\text{T}_{\text{fluid}}} \\
		\delta F_{\text{T}_{\text{fluid}}} \text{NS}_{\text{f}_{\text{T}_{\text{fluid}}}}\\
		\delta F_{\text{T}_{\text{fluid}}} \text{NS}_{\text{F}_{\text{T}_{\text{fluid}}}}\\
		\delta F_{\text{T}_{\text{fluid}}} \text{NS}_{\text{T}_{\text{fluid}_M}}\\
	\end{pmatrix}
	d\Omega \cup X + $\\

		$\int_{\Omega \cup X}
	\begin{pmatrix}
		\lambda_{\vec{u}} \\ \lambda_p \\ \lambda_{f_u} \\ \lambda_{F_u} \\ \lambda_{U_M}\\ \lambda_{T_{\text{fluid}}} \\ \lambda_{f_{T_{\text{fluid}}}} \\ \lambda_{F_{T_{\text{fluid}}}} \\ \lambda_{T_{\text{fluid}_M}}
	\end{pmatrix}
	\cdot
	\begin{pmatrix}
		\delta T_M \text{NS}_{\text{mom}} \\
		\delta T_M \text{NS}_{\text{conti}}\\
		\delta T_M \text{NS}_{\text{f}_u} \\
		\delta T_M \text{NS}_{\text{F}_u} \\
		\delta T_M \text{NS}_{\text{U}_M} \\
		\delta T_M \text{NS}_{\text{T}_{\text{fluid}}} \\
		\delta T_M \text{NS}_{\text{f}_{\text{T}_{\text{fluid}}}}\\
		\delta T_M \text{NS}_{\text{F}_{\text{T}_{\text{fluid}}}}\\
		\delta T_M \text{NS}_{\text{T}_{\text{fluid}_M}}\\
	\end{pmatrix}
	d\Omega \cup X $\\
	$=0$\\
	
	\newpage
	
	$\delta_\phi L = \delta \vec{u} J + \delta p J + \delta f_u J + \delta F_u J + \delta U_M J +
	\delta T_{\text{fluid}} J + \delta f_{T_{\text{fluid}}} J + \delta F_{T_{\text{fluid}}} J + \delta T_M J +$\\
	$\int_{\Omega \cup X}
	\begin{pmatrix}
		\lambda_{\vec{u}} \\ \lambda_p \\ \lambda_{f_u} \\ \lambda_{F_u} \\ \lambda_{U_M}\\ \lambda_{T_{\text{fluid}}} \\ \lambda_{f_{T_{\text{fluid}}}} \\ \lambda_{F_{T_{\text{fluid}}}} \\ \lambda_{T_{\text{fluid}_M}}
	\end{pmatrix}
	\cdot
	\begin{pmatrix}
		\delta \vec{u} \text{NS}_{\text{mom}} \\
		\delta \vec{u} \text{NS}_{\text{conti}}\\
		0 \\
		0 \\
		\delta \vec{u} \text{NS}_{\text{U}_M} \\
		\delta \vec{u} \text{NS}_{\text{T}_{\text{fluid}}} \\
		0\\
		0\\
		0\\
	\end{pmatrix}
	d\Omega \cup X + $\\

	$\int_{\Omega \cup X}
	\begin{pmatrix}
		\lambda_{\vec{u}} \\ \lambda_p \\ \lambda_{f_u} \\ \lambda_{F_u} \\ \lambda_{U_M}\\ \lambda_{T_{\text{fluid}}} \\ \lambda_{f_{T_{\text{fluid}}}} \\ \lambda_{F_{T_{\text{fluid}}}} \\ \lambda_{T_{\text{fluid}_M}}
	\end{pmatrix}
	\cdot
	\begin{pmatrix}
		\delta p \text{NS}_{\text{mom}} \\
		0\\
		0 \\
		0 \\
		0 \\
		0 \\
		0\\
		0\\
		0\\
	\end{pmatrix}
	d\Omega \cup X + $\\

	$\int_{\Omega \cup X}
	\begin{pmatrix}
		\lambda_{\vec{u}} \\ \lambda_p \\ \lambda_{f_u} \\ \lambda_{F_u} \\ \lambda_{U_M}\\ \lambda_{T_{\text{fluid}}} \\ \lambda_{f_{T_{\text{fluid}}}} \\ \lambda_{F_{T_{\text{fluid}}}} \\ \lambda_{T_{\text{fluid}_M}}
	\end{pmatrix}
	\cdot
	\begin{pmatrix}
		\delta f_u \text{NS}_{\text{mom}} \\
		0\\
		\delta f_u \text{NS}_{\text{f}_u} \\
		0 \\
		0 \\
		0 \\
		0\\
		0\\
		0\\
	\end{pmatrix}
	d\Omega \cup X + $\\

	$\int_{\Omega \cup X}
	\begin{pmatrix}
		\lambda_{\vec{u}} \\ \lambda_p \\ \lambda_{f_u} \\ \lambda_{F_u} \\ \lambda_{U_M}\\ \lambda_{T_{\text{fluid}}} \\ \lambda_{f_{T_{\text{fluid}}}} \\ \lambda_{F_{T_{\text{fluid}}}} \\ \lambda_{T_{\text{fluid}_M}}
	\end{pmatrix}
	\cdot
	\begin{pmatrix}
		0 \\
		0\\
		\delta F_u \text{NS}_{\text{f}_u} \\
		\delta F_u \text{NS}_{\text{F}_u} \\
		0 \\
		0 \\
		0\\
		0\\
		0\\
	\end{pmatrix}
	d\Omega \cup X + $\\

	$\int_{\Omega \cup X}
	\begin{pmatrix}
		\lambda_{\vec{u}} \\ \lambda_p \\ \lambda_{f_u} \\ \lambda_{F_u} \\ \lambda_{U_M}\\ \lambda_{T_{\text{fluid}}} \\ \lambda_{f_{T_{\text{fluid}}}} \\ \lambda_{F_{T_{\text{fluid}}}} \\ \lambda_{T_{\text{fluid}_M}}
	\end{pmatrix}
	\cdot
	\begin{pmatrix}
		0 \\
		0\\
		0 \\
		\delta U_M \text{NS}_{\text{F}_u} \\
		\delta U_M \text{NS}_{\text{U}_M} \\
		0 \\
		0\\
		0\\
		0\\
	\end{pmatrix}
	d\Omega \cup X + $\\

	$\int_{\Omega \cup X}
	\begin{pmatrix}
		\lambda_{\vec{u}} \\ \lambda_p \\ \lambda_{f_u} \\ \lambda_{F_u} \\ \lambda_{U_M}\\ \lambda_{T_{\text{fluid}}} \\ \lambda_{f_{T_{\text{fluid}}}} \\ \lambda_{F_{T_{\text{fluid}}}} \\ \lambda_{T_{\text{fluid}_M}}
	\end{pmatrix}
	\cdot
	\begin{pmatrix}
		0 \\
		0\\
		0 \\
		0 \\
		0 \\
		\delta T_{\text{fluid}} \text{NS}_{\text{T}_{\text{fluid}}} \\
		0\\
		0\\
		\delta T_{\text{fluid}} \text{NS}_{\text{T}_{\text{fluid}_M}}\\
	\end{pmatrix}
	d\Omega \cup X + $\\

	$\int_{\Omega \cup X}
	\begin{pmatrix}
		\lambda_{\vec{u}} \\ \lambda_p \\ \lambda_{f_u} \\ \lambda_{F_u} \\ \lambda_{U_M}\\ \lambda_{T_{\text{fluid}}} \\ \lambda_{f_{T_{\text{fluid}}}} \\ \lambda_{F_{T_{\text{fluid}}}} \\ \lambda_{T_{\text{fluid}_M}}
	\end{pmatrix}
	\cdot
	\begin{pmatrix}
		0 \\
		0\\
		0 \\
		0 \\
		0 \\
		\delta f_{\text{T}_{\text{fluid}}} \text{NS}_{\text{T}_{\text{fluid}}} \\
		\delta f_{\text{T}_{\text{fluid}}} \text{NS}_{\text{f}_{\text{T}_{\text{fluid}}}}\\
		0\\
		0\\
	\end{pmatrix}
	d\Omega \cup X + $\\

	$\int_{\Omega \cup X}
	\begin{pmatrix}
		\lambda_{\vec{u}} \\ \lambda_p \\ \lambda_{f_u} \\ \lambda_{F_u} \\ \lambda_{U_M}\\ \lambda_{T_{\text{fluid}}} \\ \lambda_{f_{T_{\text{fluid}}}} \\ \lambda_{F_{T_{\text{fluid}}}} \\ \lambda_{T_{\text{fluid}_M}}
	\end{pmatrix}
	\cdot
	\begin{pmatrix}
		0 \\
		0\\
		0 \\
		0 \\
		0 \\
		0 \\
		\delta F_{\text{T}_{\text{fluid}}} \text{NS}_{\text{f}_{\text{T}_{\text{fluid}}}}\\
		\delta F_{\text{T}_{\text{fluid}}} \text{NS}_{\text{F}_{\text{T}_{\text{fluid}}}}\\
		0\\
	\end{pmatrix}
	d\Omega \cup X + $\\

	$\int_{\Omega \cup X}
	\begin{pmatrix}
		\lambda_{\vec{u}} \\ \lambda_p \\ \lambda_{f_u} \\ \lambda_{F_u} \\ \lambda_{U_M}\\ \lambda_{T_{\text{fluid}}} \\ \lambda_{f_{T_{\text{fluid}}}} \\ \lambda_{F_{T_{\text{fluid}}}} \\ \lambda_{T_{\text{fluid}_M}}
	\end{pmatrix}
	\cdot
	\begin{pmatrix}
		0\\
		0\\
		0 \\
		0\\
		0 \\
		0\\
		0\\
		\delta T_M \text{NS}_{\text{F}_{\text{T}_{\text{fluid}}}}\\
		\delta T_M \text{NS}_{\text{T}_{\text{fluid}_M}}\\
	\end{pmatrix}
	d\Omega \cup X $\\
	$=0$\\

	\newpage

	$\delta_\phi L = \delta \vec{u} J + \delta p J + \delta f_u J + \delta F_u J + \delta U_M J +
	\delta T_{\text{fluid}} J + \delta f_{T_{\text{fluid}}} J + \delta F_{T_{\text{fluid}}} J + \delta T_M J +$\\
	$\int_{\Omega \cup X}
	\begin{pmatrix}
		\lambda_{\vec{u}} \\ \lambda_p \\ \lambda_{f_u} \\ \lambda_{F_u} \\ \lambda_{U_M}\\ \lambda_{T_{\text{fluid}}} \\ \lambda_{f_{T_{\text{fluid}}}} \\ \lambda_{F_{T_{\text{fluid}}}} \\ \lambda_{T_{\text{fluid}_M}}
	\end{pmatrix}
	\cdot
	\begin{pmatrix}
		(\vec{u}\cdot\nabla) \delta{\vec{u}} + (\delta{\vec{u}}\cdot\nabla)\vec{u}-\frac{\mu}{\rho} \Delta \delta{\vec{u}} \\
		- \nabla \cdot \delta\vec{u}\\
		0 \\
		0 \\
		- \int \delta u(\vec{x}) \delta(\vec{x}-\vec{X}) d \Omega \\
		(\delta\vec{u} \cdot \nabla) T_{\text{fluid}} \\
		0\\
		0\\
		0\\
	\end{pmatrix}
	d\Omega \cup X + $\\

	$\int_{\Omega \cup X}
	\begin{pmatrix}
		\lambda_{\vec{u}} \\ \lambda_p \\ \lambda_{f_u} \\ \lambda_{F_u} \\ \lambda_{U_M}\\ \lambda_{T_{\text{fluid}}} \\ \lambda_{f_{T_{\text{fluid}}}} \\ \lambda_{F_{T_{\text{fluid}}}} \\ \lambda_{T_{\text{fluid}_M}}
	\end{pmatrix}
	\cdot
	\begin{pmatrix}
		\frac{1}{\rho} \nabla \delta p \\
		0\\
		0 \\
		0 \\
		0 \\
		0 \\
		0\\
		0\\
		0\\
	\end{pmatrix}
	d\Omega \cup X + $\\

	$\int_{\Omega \cup X}
	\begin{pmatrix}
		\lambda_{\vec{u}} \\ \lambda_p \\ \lambda_{f_u} \\ \lambda_{F_u} \\ \lambda_{U_M}\\ \lambda_{T_{\text{fluid}}} \\ \lambda_{f_{T_{\text{fluid}}}} \\ \lambda_{F_{T_{\text{fluid}}}} \\ \lambda_{T_{\text{fluid}_M}}
	\end{pmatrix}
	\cdot
	\begin{pmatrix}
		-\delta f_u \\
		0\\
		\delta f_u \\
		0 \\
		0 \\
		0 \\
		0\\
		0\\
		0\\
	\end{pmatrix}
	d\Omega \cup X + $\\

	$\int_{\Omega \cup X}
	\begin{pmatrix}
		\lambda_{\vec{u}} \\ \lambda_p \\ \lambda_{f_u} \\ \lambda_{F_u} \\ \lambda_{U_M}\\ \lambda_{T_{\text{fluid}}} \\ \lambda_{f_{T_{\text{fluid}}}} \\ \lambda_{F_{T_{\text{fluid}}}} \\ \lambda_{T_{\text{fluid}_M}}
	\end{pmatrix}
	\cdot
	\begin{pmatrix}
		0 \\
		0\\
		-\sum_X \delta F_u \delta (\vec{x}-\vec{X}) \\
		\delta F_u \\
		0 \\
		0 \\
		0\\
		0\\
		0\\
	\end{pmatrix}
	d\Omega \cup X + $\\

	$\int_{\Omega \cup X}
	\begin{pmatrix}
		\lambda_{\vec{u}} \\ \lambda_p \\ \lambda_{f_u} \\ \lambda_{F_u} \\ \lambda_{U_M}\\ \lambda_{T_{\text{fluid}}} \\ \lambda_{f_{T_{\text{fluid}}}} \\ \lambda_{F_{T_{\text{fluid}}}} \\ \lambda_{T_{\text{fluid}_M}}
	\end{pmatrix}
	\cdot
	\begin{pmatrix}
		0 \\
		0\\
		0 \\
		\frac{\delta U_M}{\Delta t} \\
		\delta U_M \\
		0 \\
		0\\
		0\\
		0\\
	\end{pmatrix}
	d\Omega \cup X + $\\

	$\int_{\Omega \cup X}
	\begin{pmatrix}
		\lambda_{\vec{u}} \\ \lambda_p \\ \lambda_{f_u} \\ \lambda_{F_u} \\ \lambda_{U_M}\\ \lambda_{T_{\text{fluid}}} \\ \lambda_{f_{T_{\text{fluid}}}} \\ \lambda_{F_{T_{\text{fluid}}}} \\ \lambda_{T_{\text{fluid}_M}}
	\end{pmatrix}
	\cdot
	\begin{pmatrix}
		0 \\
		0\\
		0 \\
		0 \\
		0 \\
		(\vec{u} \cdot \nabla) \delta T_{\text{fluid}} - \frac{\kappa}{\rho c_p} \nabla \cdot \nabla \delta T_{\text{fluid}} \\
		0\\
		0\\
		-\int \delta T_{\text{fluid}} \delta (\vec{x}-\vec{X}) d\Omega\\
	\end{pmatrix}
	d\Omega \cup X + $\\

	$\int_{\Omega \cup X}
	\begin{pmatrix}
		\lambda_{\vec{u}} \\ \lambda_p \\ \lambda_{f_u} \\ \lambda_{F_u} \\ \lambda_{U_M}\\ \lambda_{T_{\text{fluid}}} \\ \lambda_{f_{T_{\text{fluid}}}} \\ \lambda_{F_{T_{\text{fluid}}}} \\ \lambda_{T_{\text{fluid}_M}}
	\end{pmatrix}
	\cdot
	\begin{pmatrix}
		0 \\
		0\\
		0 \\
		0 \\
		0 \\
		-\delta f_{\text{T}_{\text{fluid}}} \\
		\delta f_{\text{T}_{\text{fluid}}}\\
		0\\
		0\\
	\end{pmatrix}
	d\Omega \cup X + $\\

	$\int_{\Omega \cup X}
	\begin{pmatrix}
		\lambda_{\vec{u}} \\ \lambda_p \\ \lambda_{f_u} \\ \lambda_{F_u} \\ \lambda_{U_M}\\ \lambda_{T_{\text{fluid}}} \\ \lambda_{f_{T_{\text{fluid}}}} \\ \lambda_{F_{T_{\text{fluid}}}} \\ \lambda_{T_{\text{fluid}_M}}
	\end{pmatrix}
	\cdot
	\begin{pmatrix}
		0 \\
		0\\
		0 \\
		0 \\
		0 \\
		0 \\
		-\sum_X \delta F_{\text{T}_{\text{fluid}}} \delta (\vec{x}-\vec{X}) \\
		\delta F_{\text{T}_{\text{fluid}}}\\
		0\\
	\end{pmatrix}
	d\Omega \cup X + $\\

	$\int_{\Omega \cup X}
	\begin{pmatrix}
		\lambda_{\vec{u}} \\ \lambda_p \\ \lambda_{f_u} \\ \lambda_{F_u} \\ \lambda_{U_M}\\ \lambda_{T_{\text{fluid}}} \\ \lambda_{f_{T_{\text{fluid}}}} \\ \lambda_{F_{T_{\text{fluid}}}} \\ \lambda_{T_{\text{fluid}_M}}
	\end{pmatrix}
	\cdot
	\begin{pmatrix}
		0\\
		0\\
		0 \\
		0\\
		0 \\
		0\\
		0\\
		\frac{\delta T_M}{\Delta t}\\
		\delta T_M\\
	\end{pmatrix}
	d\Omega \cup X $\\
$=0$\\

\newpage
\fontsize{8}{6}
\begin{flushleft}
	Derivation of Immersed Boundary Navier Stokes adjoint
\end{flushleft}
\begin{flushleft}
	$\int_{\Omega \cup X} \lambda \cdot \delta \vec{u} \text{NS}d\Omega \cup X :$
\end{flushleft}
\begin{align*}
	\int_{\Omega \cup X} \lambda_{\vec{u}} \delta \vec{u} \text{NS}_{\text{mom}} d\Omega \cup X = &
	\int_{\Omega \cup X} \lambda_{\vec{u}} \cdot (\vec{u}\cdot\nabla) \delta{\vec{u}} + \lambda_{\vec{u}} \cdot (\delta{\vec{u}}\cdot\nabla)\vec{u}-\lambda_{\vec{u}} \cdot \frac{\mu}{\rho} \Delta \delta{\vec{u}} d\Omega \cup X\\
	=&\int_{\Omega \cup X} - \delta{\vec{u}} \cdot (\vec{u}\cdot\nabla) \lambda_{\vec{u}} - \delta \vec{u} \cdot \left(\nabla \lambda_{\vec{u}} \cdot \vec{u}\right) + \delta{\vec{u}} \cdot \frac{\mu}{\rho} \Delta \lambda_{\vec{u}} d\Omega \cup X +\\
	&\int_{S} \delta \vec{u} \cdot \left(\vec{u}\cdot \vec{n}\right) \lambda_{\vec{u}} + \delta \vec{u} \cdot \left(\vec{u}\cdot \lambda_{\vec{u}}\right)\vec{n} - \frac{\mu}{\rho} \lambda_{\vec{u}} \cdot \left(\nabla \delta \vec{u} \cdot \vec{n}\right) + \frac{\mu}{\rho} \delta \vec{u} \cdot \left(\nabla \lambda_{\vec{u}} \cdot \vec{n}\right) dS\\
	\int_{\Omega \cup X} \lambda_p \delta \vec{u} \text{NS}_{\text{conti}} d\Omega \cup X =&
	\int_{\Omega \cup X} -\lambda_p \nabla \cdot \delta\vec{u} d\Omega \cup X \\
	=&\int_{\Omega \cup X} \nabla\lambda_p  \cdot \delta\vec{u} d\Omega \cup X +\\
	&\int_{S}-\lambda_p \delta\vec{u} \cdot \vec{n} dS\\
	\int_{\Omega \cup X} \lambda_{f_u} \delta \vec{u} \text{NS}_{\text{f}_u} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{F_u} \delta \vec{u} \text{NS}_{\text{F}_u} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{U_M} \delta \vec{u} \text{NS}_{\text{U}_M} d\Omega \cup X =&  - \int_{X} \lambda_{U_M} \int \delta u(\vec{x}) \delta(\vec{x}-\vec{X}) d \Omega dX\\
	=&  \int \delta u(\vec{x}) \int_X -\lambda_{U_M} \delta(\vec{x}-\vec{X}) d \Omega dX\\
	=&  \int \delta u(\vec{x}) \sum_X -\lambda_{U_M} \delta(\vec{x}-\vec{X}) d \Omega dX\\
	\int_{\Omega \cup X} \lambda_{T_{\text{fluid}}} \delta \vec{u} \text{NS}_{\text{T}_{\text{fluid}}} d\Omega \cup X =& \int_{\Omega \cup X} \lambda_{T_{\text{fluid}}} (\delta\vec{u} \cdot \nabla) T_{\text{fluid}} d\Omega \cup X \\
	=& \int_{\Omega \cup X} - (T_{\text{fluid}} \nabla \lambda_{T_{\text{fluid}}}) \cdot \delta \vec{u} d\Omega \cup X +\\
	& \int_{S} T_{\text{fluid}} \lambda_{T_{\text{fluid}}} \delta \vec{u} \cdot \vec{n} dS\\
	\int_{\Omega \cup X} \lambda_{f_{T_{\text{fluid}}}} \delta \vec{u} \text{NS}_{\text{f}_{\text{T}_{\text{fluid}}}} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{F_{T_{\text{fluid}}}} \delta \vec{u} \text{NS}_{\text{F}_{\text{T}_{\text{fluid}}}} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{T_{\text{fluid}_M}} \delta \vec{u} \text{NS}_{\text{T}_{\text{fluid}_M}} d\Omega \cup X =& 0\\
\end{align*}
\begin{align*}
	\int_{\Omega \cup X} \lambda \cdot \delta \vec{u} \text{NS}d\Omega \cup X 
	=& \int_{\Omega \cup X} \delta{\vec{u}} \cdot \left[ -(\vec{u}\cdot\nabla) \lambda_{\vec{u}} - \left(\nabla \lambda_{\vec{u}} \cdot \vec{u}\right) + \frac{\mu}{\rho} \Delta \lambda_{\vec{u}} + \nabla\lambda_p - T_{\text{fluid}} \nabla \lambda_{T_{\text{fluid}}} - \sum_X \lambda_{U_M}(X) \delta(\vec{x}-\vec{X})\right] d\Omega \cup X +\\
	& \int_{S}  \delta \vec{u} \cdot \left[ \left(\vec{u}\cdot \vec{n}\right) \lambda_{\vec{u}} + \left(\vec{u}\cdot \lambda_{\vec{u}}\right)\vec{n} + \frac{\mu}{\rho} \left(\nabla \lambda_{\vec{u}} \cdot \vec{n}\right) -\lambda_p \vec{n} + T_{\text{fluid}} \lambda_{T_{\text{fluid}}} \vec{n} \right] - \frac{\mu}{\rho} \lambda_{\vec{u}} \cdot \left(\nabla \delta \vec{u} \cdot \vec{n}\right)dS
\end{align*}
\noindent\rule[1ex]{\textwidth}{1pt}
\newpage
\begin{flushleft}
	$\int_{\Omega \cup X} \lambda \cdot \delta p \text{NS}d\Omega \cup X:$
\end{flushleft}
\begin{align*}
	\int_{\Omega \cup X} \lambda_{\vec{u}} \delta p \text{NS}_{\text{mom}} d\Omega \cup X  
	=& \int_{\Omega \cup X} \lambda_{\vec{u}} \frac{1}{\rho} \nabla \delta p d\Omega \cup X \\
	=& \int_{\Omega \cup X} - \delta p \frac{1}{\rho} \nabla \cdot \lambda_{\vec{u}} d\Omega \cup X + \\
	 &\int_{S} \delta p \lambda_{\vec{u}} \cdot \vec{n} dS\\
	\int_{\Omega \cup X} \lambda_p \delta p \text{NS}_{\text{conti}} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{f_u} \delta p \text{NS}_{\text{f}_u} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{F_u} \delta p \text{NS}_{\text{F}_u} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{U_M} \delta p \text{NS}_{\text{U}_M} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{T_{\text{fluid}}} \delta p \text{NS}_{\text{T}_{\text{fluid}}} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{f_{T_{\text{fluid}}}} \delta p \text{NS}_{\text{f}_{\text{T}_{\text{fluid}}}} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{F_{T_{\text{fluid}}}} \delta p \text{NS}_{\text{F}_{\text{T}_{\text{fluid}}}} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{T_{\text{fluid}_M}} \delta p \text{NS}_{\text{T}_{\text{fluid}_M}} d\Omega \cup X =& 0\\
\end{align*}
\begin{align*}
	\int_{\Omega \cup X} \lambda \cdot \delta p \text{NS}d\Omega \cup X 
	=&\int_{\Omega \cup X} \delta p \left[ -\frac{1}{\rho} \nabla \cdot \lambda_{\vec{u}}\right] d\Omega \cup X + \\
	&\int_{S} \delta p \lambda_{\vec{u}} \cdot \vec{n} dS
\end{align*}
\noindent\rule[1ex]{\textwidth}{1pt}
\begin{flushleft}
	$\int_{\Omega \cup X} \lambda \cdot \delta f_u \text{NS}d\Omega \cup X :$
\end{flushleft}
\begin{align*}
	\int_{\Omega \cup X} \lambda_{\vec{u}} \delta f_u \text{NS}_{\text{mom}} d\Omega \cup X =& -\int_{\Omega \cup X} \lambda_{\vec{u}} \delta f_u d\Omega \cup X\\
	\int_{\Omega \cup X} \lambda_p \delta f_u \text{NS}_{\text{conti}} d\Omega \cup X  =& 0\\
	\int_{\Omega \cup X} \lambda_{f_u} \delta f_u \text{NS}_{\text{f}_u} d\Omega \cup X =& \int_{\Omega \cup X} \lambda_{f_u} \delta f_u d\Omega \cup X\\
	\int_{\Omega \cup X} \lambda_{F_u} \delta f_u \text{NS}_{\text{F}_u} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{U_M} \delta f_u \text{NS}_{\text{U}_M} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{T_{\text{fluid}}} \delta f_u \text{NS}_{\text{T}_{\text{fluid}}} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{f_{T_{\text{fluid}}}} \delta f_u \text{NS}_{\text{f}_{\text{T}_{\text{fluid}}}} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{F_{T_{\text{fluid}}}} \delta f_u \text{NS}_{\text{F}_{\text{T}_{\text{fluid}}}} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{T_{\text{fluid}_M}} \delta f_u \text{NS}_{\text{T}_{\text{fluid}_M}} d\Omega \cup X =& 0\\
\end{align*}
\begin{align*}
	\int_{\Omega \cup X} \lambda \cdot \delta f_u \text{NS}d\Omega \cup X 
	=&\int_{\Omega \cup X} \delta f_u \left[ -\lambda_{\vec{u}} + \lambda_{f_u} \right] d\Omega \cup X\\
\end{align*}
\noindent\rule[1ex]{\textwidth}{1pt}
\newpage
\begin{flushleft}
	$\int_{\Omega \cup X} \lambda \cdot \delta F_u \text{NS}d\Omega \cup X :$
\end{flushleft}
\begin{align*}
	\int_{\Omega \cup X} \lambda_{\vec{u}} \delta F_u \text{NS}_{\text{mom}} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_p \delta F_u \text{NS}_{\text{conti}} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{f_u} \delta F_u \text{NS}_{\text{f}_u} d\Omega \cup X 
	=& -\int_{\Omega \cup X} \lambda_{f_u} \sum_X \delta F_u \delta (\vec{x}-\vec{X}) d\Omega \cup X\\
	=& \sum_X \delta F_u \int_{\Omega} -\lambda_{f_u} \delta (\vec{x}-\vec{X}) d\Omega\\
	=& \int_X \delta F_u \int_{\Omega} -\lambda_{f_u} \delta (\vec{x}-\vec{X}) d\Omega dX\\
	\int_{\Omega \cup X} \lambda_{F_u} \delta F_u \text{NS}_{\text{F}_u} d\Omega \cup X 
	=& \int_{\Omega \cup X} \lambda_{F_u} \delta F_u d\Omega \cup X\\
	=& \int_{X} \lambda_{F_u} \delta F_u d X\\
	\int_{\Omega \cup X} \lambda_{U_M} \delta F_u \text{NS}_{\text{U}_M} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{T_{\text{fluid}}} \delta F_u \text{NS}_{\text{T}_{\text{fluid}}} d\Omega \cup X =&	0\\
	\int_{\Omega \cup X} \lambda_{f_{T_{\text{fluid}}}} \delta F_u \text{NS}_{\text{f}_{\text{T}_{\text{fluid}}}} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{F_{T_{\text{fluid}}}} \delta F_u \text{NS}_{\text{F}_{\text{T}_{\text{fluid}}}} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{T_{\text{fluid}_M}} \delta F_u \text{NS}_{\text{T}_{\text{fluid}_M}} d\Omega \cup X =& 0\\
\end{align*}
\begin{align*}
	\int_{\Omega \cup X} \lambda \cdot \delta f_u \text{NS}d\Omega \cup X 
	=&\int_{X} \delta F_u \left[ \lambda_{F_u} - \int_{\Omega} \lambda_{f_u} \delta (\vec{x}-\vec{X}) d\Omega\right] d X\\
\end{align*}
\noindent\rule[1ex]{\textwidth}{1pt}
\begin{flushleft}
	$\int_{\Omega \cup X} \lambda \cdot \delta U_M \text{NS}d\Omega \cup X :$
\end{flushleft}
\begin{align*}
	\int_{\Omega \cup X} \lambda_{\vec{u}} \delta U_M \text{NS}_{\text{mom}} d\Omega \cup X =&  0\\
	\int_{\Omega \cup X} \lambda_p \delta U_M \text{NS}_{\text{conti}} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{f_u} \delta U_M \text{NS}_{\text{f}_u} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{F_u} \delta U_M \text{NS}_{\text{F}_u} d\Omega \cup X 
	=& \int_{\Omega \cup X}\lambda_{F_u} \frac{\delta U_M}{\Delta t} d\Omega \cup X\\
	=& \int_{X} \delta U_M  \frac{\lambda_{F_u}}{\Delta t} dX\\
	\int_{\Omega \cup X} \lambda_{U_M} \delta U_M \text{NS}_{\text{U}_M} d\Omega \cup X 
	=& \int_{\Omega \cup X} \lambda_{U_M} \delta U_M d\Omega \cup X\\
	=& \int_{X} \lambda_{U_M} \delta U_M d X\\
	\int_{\Omega \cup X} \lambda_{T_{\text{fluid}}} \delta U_M \text{NS}_{\text{T}_{\text{fluid}}} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{f_{T_{\text{fluid}}}} \delta U_M \text{NS}_{\text{f}_{\text{T}_{\text{fluid}}}} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{F_{T_{\text{fluid}}}} \delta U_M \text{NS}_{\text{F}_{\text{T}_{\text{fluid}}}} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{T_{\text{fluid}_M}} \delta U_M \text{NS}_{\text{T}_{\text{fluid}_M}} d\Omega \cup X =& 0\\
\end{align*}
\begin{align*}
	\int_{\Omega \cup X} \lambda \cdot \delta U_M \text{NS}d\Omega \cup X 
	=&\int_{X} \delta U_M \left[ \lambda_{U_M} + \frac{\lambda_{F_u}}{\Delta t} \right] d X\\
\end{align*}
\noindent\rule[1ex]{\textwidth}{1pt}
\begin{flushleft}
	$\int_{\Omega \cup X} \lambda \cdot \delta T_{\text{fluid}} \text{NS}d\Omega \cup X :$
\end{flushleft}
\begin{align*}
	\int_{\Omega \cup X} \lambda_{\vec{u}} \delta T_{\text{fluid}} \text{NS}_{\text{mom}} d\Omega \cup X =&  0\\
	\int_{\Omega \cup X} \lambda_p \delta T_{\text{fluid}} \text{NS}_{\text{conti}} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{f_u} \delta T_{\text{fluid}} \text{NS}_{\text{f}_u} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{F_u} \delta T_{\text{fluid}} \text{NS}_{\text{F}_u} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{U_M} \delta T_{\text{fluid}} \text{NS}_{\text{U}_M} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{T_{\text{fluid}}} \delta T_{\text{fluid}} \text{NS}_{\text{T}_{\text{fluid}}} d\Omega \cup X 
	=&\int_{\Omega \cup X} \lambda_{T_{\text{fluid}}} (\vec{u} \cdot \nabla) \delta T_{\text{fluid}} - \lambda_{T_{\text{fluid}}} \frac{\kappa}{\rho c_p} \Delta \delta T_{\text{fluid}} d\Omega \cup X\\
	=&\int_{\Omega \cup X} - \delta T_{\text{fluid}} \nabla \lambda_{T_{\text{fluid}}} \cdot \vec{u} + \delta T_{\text{fluid}} \frac{\kappa}{\rho c_p} \Delta  \lambda_{T_{\text{fluid}}} d\Omega \cup X\\
	=&\int_{S} \delta T_{\text{fluid}} \cdot \left(\vec{u}\cdot \vec{n}\right) \lambda_{T_{\text{fluid}}} - \frac{\kappa}{\rho c_p} \lambda_{T_{\text{fluid}}} \cdot \left(\nabla \delta T_{\text{fluid}} \cdot \vec{n}\right) + \frac{\kappa}{\rho c_p} \delta T_{\text{fluid}} \cdot \left(\nabla \lambda_{T_{\text{fluid}}} \cdot \vec{n}\right) dS\\
	\int_{\Omega \cup X} \lambda_{f_{T_{\text{fluid}}}} \delta T_{\text{fluid}} \text{NS}_{\text{f}_{\text{T}_{\text{fluid}}}} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{F_{T_{\text{fluid}}}} \delta T_{\text{fluid}} \text{NS}_{\text{F}_{\text{T}_{\text{fluid}}}} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{T_{\text{fluid}_M}} \delta T_{\text{fluid}} \text{NS}_{\text{T}_{\text{fluid}_M}} d\Omega \cup X 
	=& \int \delta T_{\text{fluid}} \int_{X} -\lambda_{T_{\text{fluid}_M}} \delta (\vec{x}-\vec{X}) dX d\Omega\\
	=& \int \delta T_{\text{fluid}} \sum_{X} -\lambda_{T_{\text{fluid}_M}} \delta (\vec{x}-\vec{X}) d\Omega\\
\end{align*}
\begin{align*}
	\int_{\Omega \cup X} \lambda \cdot \delta T_{\text{fluid}} \text{NS}d\Omega \cup X 
	=&\int_{\Omega \cup X} \delta T_{\text{fluid}} \left[ -\nabla \lambda_{T_{\text{fluid}}} \cdot \vec{u} + \frac{\kappa}{\rho c_p} \Delta  \lambda_{T_{\text{fluid}}} - \sum_{X} \lambda_{T_{\text{fluid}_M}} \delta (\vec{x}-\vec{X})\right] d\Omega \cup X\\
	=&\int_{S} \delta T_{\text{fluid}} \cdot \left[\left(\vec{u}\cdot \vec{n}\right) \lambda_{T_{\text{fluid}}}  + \frac{\kappa}{\rho c_p} \left(\nabla \lambda_{T_{\text{fluid}}} \cdot \vec{n}\right)\right]- \frac{\kappa}{\rho c_p} \lambda_{T_{\text{fluid}}} \cdot \left(\nabla \delta T_{\text{fluid}} \cdot \vec{n}\right) dS\\\\
\end{align*}
\noindent\rule[1ex]{\textwidth}{1pt}
\begin{flushleft}
	$\int_{\Omega \cup X} \lambda \cdot \delta f_{\text{T}_{\text{fluid}}} \text{NS}d\Omega \cup X :$
\end{flushleft}
\begin{align*}
	\int_{\Omega \cup X} \lambda_{\vec{u}} \delta f_{\text{T}_{\text{fluid}}} \text{NS}_{\text{mom}} d\Omega \cup X =&  0\\
	\int_{\Omega \cup X} \lambda_p \delta f_{\text{T}_{\text{fluid}}} \text{NS}_{\text{conti}} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{f_u} \delta f_{\text{T}_{\text{fluid}}} \text{NS}_{\text{f}_u} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{F_u} \delta f_{\text{T}_{\text{fluid}}} \text{NS}_{\text{F}_u} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{U_M} \delta f_{\text{T}_{\text{fluid}}} \text{NS}_{\text{U}_M} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{T_{\text{fluid}}} \delta f_{\text{T}_{\text{fluid}}} \text{NS}_{\text{T}_{\text{fluid}}} d\Omega \cup X =& \int_{\Omega \cup X} -\lambda_{T_{\text{fluid}}}\delta f_{\text{T}_{\text{fluid}}}d\Omega \cup X\\
	\int_{\Omega \cup X} \lambda_{f_{T_{\text{fluid}}}} \delta f_{\text{T}_{\text{fluid}}} \text{NS}_{\text{f}_{\text{T}_{\text{fluid}}}} d\Omega \cup X =& \int_{\Omega \cup X} \lambda_{f_{T_{\text{fluid}}}} \delta f_{\text{T}_{\text{fluid}}}d\Omega \cup X\\
	\int_{\Omega \cup X} \lambda_{F_{T_{\text{fluid}}}} \delta f_{\text{T}_{\text{fluid}}} \text{NS}_{\text{F}_{\text{T}_{\text{fluid}}}} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{T_{\text{fluid}_M}} \delta f_{\text{T}_{\text{fluid}}} \text{NS}_{\text{T}_{\text{fluid}_M}} d\Omega \cup X =& 0\\
\end{align*}
\begin{align*}
	\int_{\Omega \cup X} \lambda \cdot \delta f_{\text{T}_{\text{fluid}}} \text{NS}d\Omega \cup X 
	=&\int_{\Omega \cup X} \delta f_{\text{T}_{\text{fluid}}} \left[ - \lambda_{T_{\text{fluid}}} +\lambda_{f_{T_{\text{fluid}}}}\right] d\Omega \cup XS\\
\end{align*}
\noindent\rule[1ex]{\textwidth}{1pt}
\begin{flushleft}
	$\int_{\Omega \cup X} \lambda \cdot \delta F_{\text{T}_{\text{fluid}}} \text{NS}d\Omega \cup X :$
\end{flushleft}
\begin{align*}
	\int_{\Omega \cup X} \lambda_{\vec{u}} \delta F_{\text{T}_{\text{fluid}}} \text{NS}_{\text{mom}} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_p \delta F_{\text{T}_{\text{fluid}}} \text{NS}_{\text{conti}} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{f_u} \delta F_{\text{T}_{\text{fluid}}} \text{NS}_{\text{f}_u} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{F_u} \delta F_{\text{T}_{\text{fluid}}} \text{NS}_{\text{F}_u} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{U_M} \delta F_{\text{T}_{\text{fluid}}} \text{NS}_{\text{U}_M} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{T_{\text{fluid}}} \delta F_{\text{T}_{\text{fluid}}} \text{NS}_{\text{T}_{\text{fluid}}} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{f_{T_{\text{fluid}}}} \delta F_{\text{T}_{\text{fluid}}} \text{NS}_{\text{f}_{\text{T}_{\text{fluid}}}} d\Omega \cup X 
	=& -\int_{\Omega \cup X} \lambda_{f_{T_{\text{fluid}}}} \sum_X \delta F_{\text{T}_{\text{fluid}}} \delta (\vec{x}-\vec{X}) d\Omega \cup X\\
	=& \sum_X \delta F_{\text{T}_{\text{fluid}}} \int_{\Omega \cup X} -\lambda_{f_{T_{\text{fluid}}}} \delta (\vec{x}-\vec{X}) d\Omega \cup X\\
	=& \int_X \delta F_{\text{T}_{\text{fluid}}} \int_{\Omega} -\lambda_{f_{T_{\text{fluid}}}} \delta (\vec{x}-\vec{X}) d\Omega dX\\
	\int_{\Omega \cup X} \lambda_{F_{T_{\text{fluid}}}} \delta F_{\text{T}_{\text{fluid}}} \text{NS}_{\text{F}_{\text{T}_{\text{fluid}}}} d\Omega \cup X 
	=& \int_{\Omega \cup X} \lambda_{F_{T_{\text{fluid}}}} \delta F_{\text{T}_{\text{fluid}}} d\Omega \cup X\\
	=& \int_{X} \lambda_{F_{T_{\text{fluid}}}} \delta F_{\text{T}_{\text{fluid}}} d X\\
	\int_{\Omega \cup X} \lambda_{T_{\text{fluid}_M}} \delta F_{\text{T}_{\text{fluid}}} \text{NS}_{\text{T}_{\text{fluid}_M}} d\Omega \cup X =& 0\\
\end{align*}
\begin{align*}
	\int_{\Omega \cup X} \lambda \cdot \delta F_{\text{T}_{\text{fluid}}} \text{NS}d\Omega \cup X 
	=&\int_{X} \delta F_{\text{T}_{\text{fluid}}} \left[ -\int_{\Omega} \lambda_{f_{T_{\text{fluid}}}} \delta (\vec{x}-\vec{X}) d\Omega + \lambda_{F_{T_{\text{fluid}}}}\right] dX\\
\end{align*}
\noindent\rule[1ex]{\textwidth}{1pt}
\begin{flushleft}
	$\int_{\Omega \cup X} \lambda \cdot \delta T_M \text{NS}d\Omega \cup X :$
\end{flushleft}
\begin{align*}
	\int_{\Omega \cup X} \lambda_{\vec{u}} \delta T_M \text{NS}_{\text{mom}} d\Omega \cup X =&  0\\
	\int_{\Omega \cup X} \lambda_p \delta T_M \text{NS}_{\text{conti}} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{f_u} \delta T_M \text{NS}_{\text{f}_u} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{F_u} \delta T_M \text{NS}_{\text{F}_u} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{U_M} \delta T_M \text{NS}_{\text{U}_M} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{T_{\text{fluid}}} \delta T_M \text{NS}_{\text{T}_{\text{fluid}}} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{f_{T_{\text{fluid}}}} \delta T_M \text{NS}_{\text{f}_{\text{T}_{\text{fluid}}}} d\Omega \cup X =& 0\\
	\int_{\Omega \cup X} \lambda_{F_{T_{\text{fluid}}}} \delta T_M \text{NS}_{\text{F}_{\text{T}_{\text{fluid}}}} d\Omega \cup X 
	=& \int_{\Omega \cup X} \lambda_{F_{T_{\text{fluid}}}} \frac{\delta T_M}{\Delta t} d\Omega \cup X\\
	=& \int_{\Omega \cup X} \delta T_M  \frac{\lambda_{F_{T_{\text{fluid}}}}}{\Delta t} d\Omega \cup X\\
	\int_{\Omega \cup X} \lambda_{T_{\text{fluid}_M}} \delta T_M \text{NS}_{\text{T}_{\text{fluid}_M}} d\Omega \cup X =& \int_{\Omega \cup X} \lambda_{T_{\text{fluid}_M}} \delta T_M d\Omega \cup X\\
\end{align*}
\begin{align*}
	\int_{\Omega \cup X} \lambda \cdot \delta T_M \text{NS}d\Omega \cup X 
	=&\int_{X} \delta T_M \left[ \lambda_{T_{\text{fluid}_M}} + \frac{\lambda_{F_{T_{\text{fluid}}}}}{\Delta t} \right] d X\\
\end{align*}
\noindent\rule[1ex]{\textwidth}{1pt}
\newpage
\fontsize{10}{8}
\begin{flushleft}
	Adjoint Immersed Boundary Navier Stokes system
\end{flushleft}
	$-(\vec{u}\cdot\nabla) \lambda_{\vec{u}} - \left(\nabla \lambda_{\vec{u}} \cdot \vec{u}\right) + \frac{\mu}{\rho} \Delta \lambda_{\vec{u}} + \nabla\lambda_p - T_{\text{fluid}} \nabla \lambda_{T_{\text{fluid}}} - \sum_X \lambda_{U_M}(X) \delta(\vec{x}-\vec{X}) = 0$ \quad on $\Omega,X$\\
	$-\frac{1}{\rho} \nabla \cdot \lambda_{\vec{u}} = 0$ \quad on $\Omega$\\
	$-\lambda_{\vec{u}} + \lambda_{f_u} = 0$ \quad on $\Omega$\\
	$\lambda_{F_u} - \int_{\Omega} \lambda_{f_u} \delta (\vec{x}-\vec{X}) d\Omega = 0$ \quad on $\Omega,X$\\
	$\lambda_{U_M} + \frac{\lambda_{F_u}}{\Delta t}=0$ \quad on $X$\\
	$-\nabla \lambda_{T_{\text{fluid}}} \cdot \vec{u} + \frac{\kappa}{\rho c_p} \Delta  \lambda_{T_{\text{fluid}}} - \sum_{X} \lambda_{T_{\text{fluid}_M}} \delta (\vec{x}-\vec{X}) = 0$ \quad on $\Omega,X$\\
	$- \lambda_{T_{\text{fluid}}} +\lambda_{f_{T_{\text{fluid}}}} = 0$ \quad on $\Omega$\\
	$-\int_{\Omega} \lambda_{f_{T_{\text{fluid}}}} \delta (\vec{x}-\vec{X}) d\Omega + \lambda_{F_{T_{\text{fluid}}}} = 0$ \quad on $\Omega, X$\\
	$\lambda_{T_{\text{fluid}_M}} + \frac{\lambda_{F_{T_{\text{fluid}}}}}{\Delta t} =0$ \quad on $X$
\end{center}
\newpage
\begin{center}
\begin{flushleft}
	Immersed Boundary Navier Stokes system sensitivities
\end{flushleft}
$L = J + \int_{\Omega} \vec{\lambda} \cdot \text{NS}(\phi)  d\Omega$\\
$\delta L = \delta_\Gamma L + \delta_\phi L$\\
\begin{flushleft}
	Sensitivities Immersed Boundary Navier Stokes
\end{flushleft}
\begin{flushleft}
	$\delta \Gamma \text{NS}:$
\end{flushleft}
	$\delta \Gamma \text{NS}_{\text{mom}} = 0$\\
	$\delta \Gamma \text{NS}_{\text{conti}} = 0$\\
	$\delta \Gamma \text{NS}_{\text{f}_u} = \sum_X -F_u \delta \Gamma \delta(\vec{x}-\vec{X})$\\
	$\delta \Gamma \text{NS}_{\text{F}_u} = 0$\\
	$\delta \Gamma \text{NS}_{\text{U}_M} = \int -\vec{u} \delta \Gamma \delta (\vec{x}-\vec{X}) d\Omega$\\
	$\delta \Gamma \text{NS}_{\text{T}_{\text{fluid}}} = 0$\\
	$\delta \Gamma \text{NS}_{\text{f}_{\text{T}_{\text{fluid}}}} = \sum_X -F_{T_{\text{fluid}}} \delta \Gamma \delta(\vec{x}-\vec{X})$\\
	$\delta \Gamma \text{NS}_{\text{F}_{\text{T}_{\text{fluid}}}} = 0$\\
	$\delta \Gamma \text{NS}_{\text{T}_{\text{fluid}_M}} = \int -T_{\text{fluid}} \delta \Gamma \delta (\vec{x}-\vec{X})d\Omega$\\
\end{center}
\begin{center}
$\delta L = \delta_\Gamma J + \int_{\Omega \cup X}
\begin{pmatrix}
	\lambda_{\vec{u}} \\ \lambda_p \\ \lambda_{f_u} \\ \lambda_{F_u} \\ \lambda_{U_M}\\ \lambda_{T_{\text{fluid}}} \\ \lambda_{f_{T_{\text{fluid}}}} \\ \lambda_{F_{T_{\text{fluid}}}} \\ \lambda_{T_{\text{fluid}_M}}
\end{pmatrix}
\cdot
\begin{pmatrix}
	\delta \Gamma \text{NS}_{\text{mom}} \\
	\delta \Gamma \text{NS}_{\text{conti}}\\
	\delta \Gamma \text{NS}_{\text{f}_u} \\
	\delta \Gamma \text{NS}_{\text{F}_u} \\
	\delta \Gamma \text{NS}_{\text{U}_M} \\
	\delta \Gamma \text{NS}_{\text{T}_{\text{fluid}}} \\
	\delta \Gamma \text{NS}_{\text{f}_{\text{T}_{\text{fluid}}}}\\
	\delta \Gamma \text{NS}_{\text{F}_{\text{T}_{\text{fluid}}}}\\
	\delta \Gamma \text{NS}_{\text{T}_{\text{fluid}_M}}\\
\end{pmatrix}
d\Omega \cup X =
\delta_\Gamma J + \int_{\Omega \cup X}
\begin{pmatrix}
	\lambda_{\vec{u}} \\ \lambda_p \\ \lambda_{f_u} \\ \lambda_{F_u} \\ \lambda_{U_M}\\ \lambda_{T_{\text{fluid}}} \\ \lambda_{f_{T_{\text{fluid}}}} \\ \lambda_{F_{T_{\text{fluid}}}} \\ \lambda_{T_{\text{fluid}_M}}
\end{pmatrix}
\cdot
\begin{pmatrix}
	0\\
	0\\
	\sum_X -F_u \delta \Gamma \delta(\vec{x}-\vec{X}) \\
	0 \\
	\int -\vec{u} \delta \Gamma \delta (\vec{x}-\vec{X})d\Omega \\
	0 \\
	\sum_X -F_{T_{\text{fluid}}} \delta \Gamma \delta(\vec{x}-\vec{X})\\
	0\\
	\int -T_{\text{fluid}} \delta \Gamma \delta (\vec{x}-\vec{X})d\Omega\\
\end{pmatrix}
d\Omega \cup X$\\
$=
\delta_\Gamma J + \int_{\Omega \cup X}
\begin{pmatrix}
	\lambda_{f_u} \\ \lambda_{U_M}\\ \lambda_{f_{T_{\text{fluid}}}} \\ \lambda_{T_{\text{fluid}_M}}
\end{pmatrix}
\cdot
\begin{pmatrix}
	\sum_X -F_u \delta \Gamma \delta(\vec{x}-\vec{X}) \\
	\int -\vec{u} \delta \Gamma \delta (\vec{x}-\vec{X})d\Omega \\
	\sum_X -F_{T_{\text{fluid}}} \delta \Gamma \delta(\vec{x}-\vec{X})\\
	\int -T_{\text{fluid}} \delta \Gamma \delta (\vec{x}-\vec{X})d\Omega\\
\end{pmatrix}
d\Omega \cup X$\\
\begin{align*}
\delta_\Gamma L=
	&\delta_\Gamma J + \\
	&\int_{\Omega}
	\lambda_{f_u} \sum_X -F_u \delta \Gamma \delta(\vec{x}-\vec{X}) + 
	\lambda_{f_{T_{\text{fluid}}}} \sum_X -F_{T_{\text{fluid}}} \delta \Gamma \delta(\vec{x}-\vec{X}) 
	d\Omega + \\
	&\int_X
	\lambda_{U_M} \int -\vec{u} \delta \Gamma \delta (\vec{x}-\vec{X})d\Omega dX + 
	\lambda_{T_{\text{fluid}_M}} \int -T_{\text{fluid}} \delta \Gamma \delta (\vec{x}-\vec{X})d\Omega
	dX
\end{align*}
\end{center}
\end{document}
